{"version":3,"sources":["./src/app/promos/customer/customer.module.ts","./src/app/promos/customer/customer-promo-coupons/customer-promo-coupons.component.ts","./src/app/promos/customer/customer-promo-coupons/customer-promo-coupons.component.html","./src/app/promos/customer/customer-routing.module.ts","./src/app/promos/customer/customer-promos/customer-promos.component.ts","./src/app/promos/customer/customer-promos/customer-promos.component.html"],"names":[],"mappings":"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","file":"customer-customer-module.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\n\r\nimport { CustomerRoutingModule } from './customer-routing.module';\r\nimport { CustomerPromosComponent } from './customer-promos/customer-promos.component';\r\nimport { CustomerPromoCouponsComponent } from './customer-promo-coupons/customer-promo-coupons.component';\r\n\r\n@NgModule({\r\n  declarations: [CustomerPromosComponent, CustomerPromoCouponsComponent],\r\n  imports: [CommonModule, CustomerRoutingModule],\r\n  exports: [CustomerPromosComponent, CustomerPromoCouponsComponent],\r\n})\r\nexport class CustomerModule {}\r\n","import { Component } from '@angular/core';\r\nimport {\r\n  DocumentData,\r\n  DocumentReference,\r\n  QuerySnapshot,\r\n} from '@angular/fire/firestore';\r\nimport { ActivatedRoute } from '@angular/router';\r\nimport { Store } from '@ngrx/store';\r\nimport { Observable, Subscription } from 'rxjs';\r\nimport { selectAuthUserProfile } from 'src/app/auth';\r\nimport { FireService } from 'src/app/fire.service';\r\nimport { AppState } from 'src/app/shared/app-state';\r\nimport { generateCouponCode } from 'src/app/shared/coupon-generator';\r\nimport {\r\n  CouponDTO,\r\n  CouponPrize,\r\n  CouponPrizeObject,\r\n} from 'src/app/shared/models/Coupon';\r\nimport { ParticipantDTO, PromoDTO } from 'src/app/shared/models/Promo';\r\nimport { CustomerDTO, UserDTO } from 'src/app/shared/models/User';\r\n\r\n@Component({\r\n  selector: 'app-customer-promo-coupons',\r\n  templateUrl: './customer-promo-coupons.component.html',\r\n  styleUrls: ['./customer-promo-coupons.component.scss'],\r\n})\r\nexport class CustomerPromoCouponsComponent {\r\n  pid: string = null;\r\n  uid: string = null;\r\n  sub: Subscription = new Subscription();\r\n  user$: Observable<UserDTO> = this.store.select(selectAuthUserProfile);\r\n  data: CouponDTO[] = [];\r\n  coupons: { points: CouponDTO[]; prize: CouponDTO[] } = {\r\n    points: [],\r\n    prize: [],\r\n  };\r\n  currentPromo: PromoDTO = null;\r\n  currentUser: CustomerDTO = null;\r\n  currentParticipant: ParticipantDTO = null;\r\n  canRedeem = false;\r\n  redeemSuccess = false;\r\n  exchangingProcess = false;\r\n\r\n  constructor(\r\n    private fire: FireService,\r\n    public route: ActivatedRoute,\r\n    private store: Store<AppState>\r\n  ) {\r\n    this.sub.add(\r\n      this.user$.subscribe((user) => {\r\n        this.currentUser = user as CustomerDTO;\r\n      })\r\n    );\r\n\r\n    this.sub.add(\r\n      this.route.queryParams.subscribe((data) => {\r\n        this.pid = data.pid;\r\n        this.uid = data.uid;\r\n\r\n        this.reqPromo();\r\n        this.reqCustomerPromoCoupons();\r\n      })\r\n    );\r\n  }\r\n\r\n  reqPromo() {\r\n    this.fire.db.firestore\r\n      .collection('promos')\r\n      .where('pid', '==', this.pid)\r\n      .get()\r\n      .then((data: QuerySnapshot<DocumentData>) => {\r\n        data.forEach((item) => {\r\n          this.currentPromo = item.data() as PromoDTO;\r\n          this.currentParticipant = this.findParticipant();\r\n        });\r\n      });\r\n  }\r\n\r\n  reqCustomerPromoCoupons() {\r\n    let promisePromos: PromoDTO[] = [];\r\n    let promiseCoupons: CouponDTO[] = [];\r\n\r\n    Promise.all([\r\n      this.fire.db.firestore\r\n        .collection('coupons')\r\n        .where('customerId', '==', this.uid)\r\n        .where('promoId', '==', this.pid)\r\n        .get(),\r\n      ,\r\n      this.fire.db.firestore.collection('promos').get(),\r\n    ])\r\n      .then(\r\n        (\r\n          values: [\r\n            QuerySnapshot<DocumentData[]>,\r\n            any,\r\n            QuerySnapshot<DocumentData[]>\r\n          ]\r\n        ) => {\r\n          values.forEach((value: QuerySnapshot<DocumentData[]>) => {\r\n            if (value) {\r\n              value.forEach((v: DocumentData) => {\r\n                const data = { ...v.data() };\r\n                let item: PromoDTO | CouponDTO = null;\r\n\r\n                if (data['pid']) {\r\n                  item = data as PromoDTO;\r\n                  promisePromos.push(item);\r\n                }\r\n\r\n                if (data['promoId']) {\r\n                  item = data as CouponDTO;\r\n                  promiseCoupons.push(item);\r\n                }\r\n              });\r\n            }\r\n          });\r\n        }\r\n      )\r\n      .then(() => {\r\n        this.data = [];\r\n        this.coupons.points = [];\r\n        this.coupons.prize = [];\r\n\r\n        promiseCoupons.forEach((coupon) => {\r\n          let item: any = null;\r\n          promisePromos.forEach((promo) => {\r\n            if (coupon.promoId === promo.pid) {\r\n              item = { ...coupon, promoName: promo.promoName };\r\n              this.data.push(item);\r\n              this.currentPromo = promo;\r\n              this.currentParticipant = this.findParticipant();\r\n            }\r\n          });\r\n        });\r\n      })\r\n      .finally(() => {\r\n        this.separateCoupons();\r\n        this.setCanRedeem();\r\n      });\r\n  }\r\n\r\n  findParticipant() {\r\n    const part = this.currentPromo?.participantsTable.find(\r\n      (p) => p.uid === this.uid\r\n    );\r\n\r\n    return part;\r\n  }\r\n\r\n  setCanRedeem() {\r\n    this.canRedeem =\r\n      this.currentParticipant?.currentPoints >= this.currentPromo?.pointsRedeem;\r\n  }\r\n\r\n  private configureCouponPureDTO(): CouponDTO {\r\n    const code = generateCouponCode();\r\n\r\n    const prize: CouponPrizeObject = {\r\n      description: this.currentPromo.prizeDescription,\r\n      quantity: this.currentPromo.prizeQuantity,\r\n    };\r\n\r\n    const promoId = this.pid;\r\n    const customerId = this.uid;\r\n\r\n    const coupon: CouponPrize = {\r\n      promoId,\r\n      customerId,\r\n      code,\r\n      prize,\r\n      realised: false,\r\n      id: '',\r\n      type: 'prize',\r\n    };\r\n\r\n    const couponPureDTO: CouponDTO = Object.assign({}, coupon);\r\n    return couponPureDTO;\r\n  }\r\n\r\n  private configurePromoPureDTO() {\r\n    let promo: PromoDTO = { ...this.currentPromo };\r\n\r\n    promo.participantsTable.forEach((p) => {\r\n      if (p.uid === this.uid) {\r\n        p.currentPoints -= promo.pointsRedeem;\r\n      }\r\n    });\r\n\r\n    const promoPureDTO: PromoDTO = Object.assign({}, promo);\r\n    return promoPureDTO;\r\n  }\r\n\r\n  generateCodeAndSubmit() {\r\n    const couponPure: CouponDTO = this.configureCouponPureDTO();\r\n    const promoPure: PromoDTO = this.configurePromoPureDTO();\r\n\r\n    Promise.all([\r\n      this.fire\r\n        .getCouponsCollectionRef()\r\n        .add(couponPure)\r\n        .then((data: DocumentReference) => {\r\n          const couponId: string = data.id;\r\n          const newDocument = { ...couponPure, id: couponId };\r\n          const newDocumentPure = Object.assign({}, newDocument);\r\n\r\n          this.fire\r\n            .getCouponsCollectionRef()\r\n            .doc(couponId)\r\n            .set({ ...newDocumentPure });\r\n        }),\r\n      this.fire\r\n        .getPromosCollectionRef()\r\n        .doc(promoPure.pid)\r\n        .set({ ...promoPure }),\r\n    ]).finally(() => {\r\n      this.reqCustomerPromoCoupons();\r\n    });\r\n  }\r\n\r\n  separateCoupons() {\r\n    this.data.forEach((coupon) => {\r\n      this.coupons[coupon.type].push(coupon);\r\n    });\r\n  }\r\n\r\n  realizeCoupon(coupon: CouponDTO) {\r\n    if (!coupon.realised) {\r\n      this.exchangingProcess = true;\r\n      const promo = this.currentPromo;\r\n      let coupons: CouponDTO[] = [];\r\n\r\n      const participants: ParticipantDTO[] = promo.participantsTable.map(\r\n        (p) => {\r\n          if (p.uid === this.uid) {\r\n            p.currentPoints = Number(p.currentPoints) + Number(coupon.points);\r\n\r\n            return p;\r\n          } else return p;\r\n        }\r\n      );\r\n\r\n      this.fire\r\n        .getPromosCollectionRef()\r\n        .doc(promo.pid)\r\n        .update({ participantsTable: participants })\r\n        .then(() => {\r\n          this.fire\r\n            .getCouponsCollectionRef()\r\n            .doc(coupon.id)\r\n            .update({ realised: true })\r\n\r\n            .then(() => {\r\n              this.fire.db.firestore\r\n                .collection('coupons')\r\n                .where('customerId', '==', this.uid)\r\n                .where('promoId', '==', promo.pid)\r\n                .get()\r\n                .then((value: QuerySnapshot<DocumentData[]>) => {\r\n                  if (value) {\r\n                    value.forEach((v: DocumentData) => {\r\n                      const data: CouponDTO = { ...v.data() };\r\n                      coupons.push(data);\r\n                    });\r\n                  }\r\n                });\r\n            })\r\n            .finally(() => {\r\n              this.data = coupons;\r\n              this.currentPromo = promo;\r\n              this.reqCustomerPromoCoupons();\r\n              this.exchangingProcess = false;\r\n            });\r\n        });\r\n    }\r\n  }\r\n\r\n  ngOnDestroy() {\r\n    this.sub.unsubscribe();\r\n  }\r\n}\r\n","<div class=\"wrapper\">\r\n  <p class=\"table__name\">\r\n    TWOJE KUPONY PUNKTOWE ORAZ KUPONY NA NAGRODY W PROMOCJI\r\n  </p>\r\n\r\n  <div class=\"tables\">\r\n    <!-- ## KUPONY PUNKTOWE ## -->\r\n    <table class=\"table\">\r\n      <label class=\"label\">Kupony punktowe</label>\r\n\r\n      <thead class=\"table__head\">\r\n        <tr class=\"table__row table__row--head\">\r\n          <th class=\"cell cell--header\">\r\n            <label class=\"cell__label\"> Punkty na kuponie</label>\r\n          </th>\r\n\r\n          <th class=\"cell cell--header\">\r\n            <label class=\"cell__label\"> Kod kuponu</label>\r\n          </th>\r\n\r\n          <th class=\"cell cell--header\">\r\n            <label class=\"cell__label\"> Czy kupon został zrealizowany?</label>\r\n          </th>\r\n\r\n          <th class=\"cell cell--actions\">\r\n            <label class=\"cell__label\"> Operacje - Kupony </label>\r\n          </th>\r\n        </tr>\r\n      </thead>\r\n\r\n      <tbody class=\"table__body\">\r\n        <ng-container *ngIf=\"coupons.points && coupons.points.length\">\r\n          <tr\r\n            *ngFor=\"let item of coupons.points\"\r\n            class=\"table__row table__row--body\"\r\n          >\r\n            <td class=\"cell cell--data cell--participant-details\">\r\n              <label class=\"cell__label\"> {{ item.points }}</label>\r\n            </td>\r\n\r\n            <td class=\"cell cell--data cell--participant-details\">\r\n              <label class=\"cell__label\"> {{ item.code }}</label>\r\n            </td>\r\n\r\n            <td class=\"cell cell--data cell--participant-details\">\r\n              <label class=\"cell__label\">\r\n                {{ item.realised ? \"TAK\" : \"NIE\" }}</label\r\n              >\r\n            </td>\r\n\r\n            <td class=\"cell cell--actions\">\r\n              <label\r\n                *ngIf=\"item.realised === false\"\r\n                class=\"action-label action-label--edit\"\r\n                (click)=\"realizeCoupon(item)\"\r\n              >\r\n                ZREALIZUJ KUPON\r\n              </label>\r\n              <label *ngIf=\"item.realised === true\" class=\"disabled-label\">\r\n                ZREALIZOWANO\r\n              </label>\r\n            </td>\r\n          </tr>\r\n        </ng-container>\r\n      </tbody>\r\n    </table>\r\n\r\n    <section class=\"points-exchange\">\r\n      <label class=\"label\">Wymiana punktów na kupon z nagrodą</label>\r\n\r\n      <p class=\"prizes\">\r\n        Ilość nagród odebranych dotychczas w tej promocji:\r\n        {{ currentParticipant?.prizeCounter }}\r\n      </p>\r\n\r\n      <div class=\"detail\">\r\n        <label class=\"detail__label\">Twoje punkty</label>\r\n        <ng-container *ngIf=\"currentParticipant\">\r\n          <p class=\"detail__value\">{{ currentParticipant?.currentPoints }}</p>\r\n        </ng-container>\r\n      </div>\r\n\r\n      <div class=\"detail\">\r\n        <label class=\"detail__label\"\r\n          >Punkty potrzebne do uzyskania nagrody</label\r\n        >\r\n        <p class=\"detail__value\">{{ currentPromo?.pointsRedeem }}</p>\r\n      </div>\r\n\r\n      <div class=\"message-wrapper\" *ngIf=\"!canRedeem\">\r\n        <div class=\"message\">Masz za mało punktów.</div>\r\n      </div>\r\n\r\n      <button\r\n        *ngIf=\"canRedeem\"\r\n        class=\"buttons\"\r\n        (click)=\"generateCodeAndSubmit()\"\r\n      >\r\n        Zamień punkty\r\n      </button>\r\n\r\n      <div class=\"message-wrapper\" *ngIf=\"redeemSuccess\">\r\n        <div class=\"message\">Operacja powiodła się.</div>\r\n      </div>\r\n    </section>\r\n\r\n    <!-- ## PUNKTY NA NAGRODY ## -->\r\n    <table class=\"table\">\r\n      <label class=\"label\">Kupony z nagrodami</label>\r\n\r\n      <thead class=\"table__head\">\r\n        <tr class=\"table__row table__row--head\">\r\n          <th class=\"cell cell--header\">\r\n            <label class=\"cell__label\"> Nagroda</label>\r\n          </th>\r\n\r\n          <th class=\"cell cell--header\">\r\n            <label class=\"cell__label\"> Kod kuponu</label>\r\n          </th>\r\n\r\n          <th class=\"cell cell--header\">\r\n            <label class=\"cell__label\"> Czy kupon został zrealizowany?</label>\r\n          </th>\r\n\r\n          <th class=\"cell cell--actions\">\r\n            <label class=\"cell__label\"> Operacje - Kupony </label>\r\n          </th>\r\n        </tr>\r\n      </thead>\r\n\r\n      <tbody class=\"table__body\">\r\n        <ng-container *ngIf=\"coupons.prize && coupons.prize.length\">\r\n          <tr\r\n            *ngFor=\"let item of coupons.prize\"\r\n            class=\"table__row table__row--body\"\r\n          >\r\n            <td\r\n              class=\"cell cell--data cell--participant-details prize-description\"\r\n            >\r\n              <label class=\"cell__label\">\r\n                {{ item?.prize?.description }}\r\n                <span class=\"quantity\">\r\n                  {{ item.prize.quantity ? \"x \" : \"\" }}\r\n                  {{ item?.prize?.quantity }}\r\n                </span>\r\n              </label>\r\n            </td>\r\n\r\n            <td class=\"cell cell--data cell--participant-details\">\r\n              <label class=\"cell__label\"> {{ item.code }}</label>\r\n            </td>\r\n\r\n            <td class=\"cell cell--data cell--participant-details\">\r\n              <label class=\"cell__label\">\r\n                {{ item.realised ? \"TAK\" : \"NIE\" }}</label\r\n              >\r\n            </td>\r\n\r\n            <td class=\"cell cell--actions\">\r\n              <label *ngIf=\"item.realised === false\">\r\n                ODBIERZ U SPRZEDAWCY\r\n              </label>\r\n              <label *ngIf=\"item.realised === true\" class=\"disabled-label\">\r\n                ZREALIZOWANO\r\n              </label>\r\n            </td>\r\n          </tr>\r\n        </ng-container>\r\n      </tbody>\r\n    </table>\r\n  </div>\r\n</div>\r\n","import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\nimport { AuthGuard } from 'src/app/auth/auth.guard';\r\nimport { CustomerPromoCouponsComponent } from './customer-promo-coupons/customer-promo-coupons.component';\r\nimport { CustomerPromosComponent } from './customer-promos/customer-promos.component';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    children: [\r\n      {\r\n        path: 'promos',\r\n        component: CustomerPromosComponent,\r\n        canActivate: [AuthGuard],\r\n        data: {\r\n          exptectedRoles: ['customer'],\r\n        },\r\n      },\r\n      {\r\n        path: 'promo/coupons',\r\n        component: CustomerPromoCouponsComponent,\r\n        canActivate: [AuthGuard],\r\n        data: {\r\n          exptectedRoles: ['customer'],\r\n        },\r\n      },\r\n    ],\r\n  },\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class CustomerRoutingModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { DocumentData } from '@angular/fire/firestore';\r\nimport { Store } from '@ngrx/store';\r\nimport { Observable, Subscription } from 'rxjs';\r\nimport { selectAuthUserProfile } from 'src/app/auth';\r\nimport { updateAuthUserData } from 'src/app/auth/auth.actions';\r\nimport { FireService } from 'src/app/fire.service';\r\nimport { AppState } from 'src/app/shared/app-state';\r\nimport { ParticipantDTO, PromoDTO } from 'src/app/shared/models/Promo';\r\nimport { AnyUserDTO, UserDTO } from 'src/app/shared/models/User';\r\n\r\n@Component({\r\n  selector: 'app-customer-promos',\r\n  templateUrl: './customer-promos.component.html',\r\n  styleUrls: ['./customer-promos.component.scss'],\r\n})\r\nexport class CustomerPromosComponent implements OnInit {\r\n  user$: Observable<UserDTO> = this.store.select(selectAuthUserProfile);\r\n  user: AnyUserDTO = null;\r\n  tableName = 'PROMOCJE W KTÓRYCH UCZESTNICZYSZ';\r\n  sub: Subscription = new Subscription();\r\n\r\n  promos$: Observable<\r\n    DocumentData[]\r\n  > = this.fire.getPromosCollectionRef().valueChanges();\r\n\r\n  customerPromos: PromoDTO[] = [];\r\n\r\n  constructor(private store: Store<AppState>, private fire: FireService) {\r\n    this.sub.add(\r\n      this.user$.subscribe((data: AnyUserDTO) => {\r\n        this.user = data;\r\n\r\n        if (this.user) {\r\n          this.sub.add(\r\n            this.promos$.subscribe((promos: PromoDTO[]) => {\r\n              const customerPromos: PromoDTO[] = promos.filter((promo) => {\r\n                return promo.participantsTable.find(\r\n                  (part) => part.uid === this.user.uid\r\n                );\r\n              });\r\n\r\n              this.customerPromos = customerPromos;\r\n            })\r\n          );\r\n        }\r\n      })\r\n    );\r\n  }\r\n\r\n  ngOnInit(): void {}\r\n\r\n  ngOnDestroy() {\r\n    this.sub.unsubscribe();\r\n  }\r\n\r\n  getParticipantPoints(promo: PromoDTO) {\r\n    let participant: ParticipantDTO = promo.participantsTable.find(\r\n      (p) => p.uid === this.user.uid\r\n    );\r\n\r\n    console.log(participant);\r\n\r\n    return participant.currentPoints;\r\n  }\r\n\r\n  resign(promo: PromoDTO, user: UserDTO) {\r\n    if (confirm('Czy na pewno chcesz zrezygnować?')) {\r\n      let resignPromo = this.customerPromos.find(\r\n        (p: PromoDTO) => promo.pid === p.pid\r\n      );\r\n\r\n      if (resignPromo) {\r\n        const newPromoParticipants: ParticipantDTO[] = resignPromo?.participantsTable?.filter(\r\n          (pt) => pt.uid !== user.uid\r\n        );\r\n\r\n        const newCustomerPromosRefs: string[] = user?.promos?.filter(\r\n          (pr: any) => pr !== promo.pid\r\n        );\r\n\r\n        const newPromo = {\r\n          ...resignPromo,\r\n          participantsTable: newPromoParticipants,\r\n          participantsTotal: newPromoParticipants?.length || 0,\r\n        };\r\n\r\n        Promise.all([\r\n          this.fire.getPromosCollectionRef().doc(promo.pid).update(newPromo),\r\n          this.fire\r\n            .getUsersCollectionRef()\r\n            .doc(user.uid)\r\n            .update({ promos: newCustomerPromosRefs }),\r\n        ])\r\n          .then((values) => {\r\n            const newUser: AnyUserDTO = {\r\n              ...user,\r\n              promos: newCustomerPromosRefs,\r\n            };\r\n            this.user = newUser;\r\n\r\n            this.store.dispatch(updateAuthUserData({ user: user }));\r\n            this.customerPromos = this.customerPromos.filter(\r\n              (cpr) => cpr.pid !== promo.pid\r\n            );\r\n          })\r\n          .catch((e) => console.log(e));\r\n      }\r\n    }\r\n  }\r\n}\r\n","<div class=\"wrapper\">\r\n  <p class=\"table__name\">{{ tableName }}</p>\r\n\r\n  <ng-container *ngIf=\"customerPromos\">\r\n    <table class=\"table\">\r\n      <!-- THEAD START -->\r\n      <thead class=\"table__head\">\r\n        <tr class=\"table__row table__row--head\">\r\n          <th class=\"cell cell--header cell--promo-details cell--promo-name\">\r\n            <label class=\"cell__label\"> Nazwa promocji</label>\r\n          </th>\r\n\r\n          <th class=\"cell cell--header cell--prize\">\r\n            <label class=\"cell__label\">Opis nagrody</label>\r\n          </th>\r\n\r\n          <th class=\"cell cell--header cell--points\">\r\n            <label class=\"cell__label\"> Twoje punkty / Potrzebne </label>\r\n          </th>\r\n          <th class=\"cell cell--header cell--points\">\r\n            <label class=\"cell__label\"> Punkty na start </label>\r\n          </th>\r\n\r\n          <th class=\"cell cell--header cell--points\">\r\n            <label class=\"cell__label\"> Przyznane kupony </label>\r\n          </th>\r\n\r\n          <th class=\"cell cell--actions\">\r\n            <label class=\"cell__label\"> Operacje - Promocje</label>\r\n          </th>\r\n        </tr>\r\n      </thead>\r\n\r\n      <!-- TBODY START -->\r\n      <tbody class=\"table__body\" *ngIf=\"customerPromos\">\r\n        <tr\r\n          *ngFor=\"let promo of customerPromos\"\r\n          class=\"table__row table__row--body\"\r\n        >\r\n          <td class=\"cell cell--data cell--promo-details cell--promo-name\">\r\n            <label class=\"cell__label\">\r\n              {{ promo.promoName }}\r\n            </label>\r\n          </td>\r\n\r\n          <td class=\"cell cell--data cell--prize cell--prize-description\">\r\n            <label class=\"cell__label\"> {{ promo.prizeDescription }} </label>\r\n          </td>\r\n\r\n          <td class=\"cell cell--data cell--points\">\r\n            <label class=\"cell__label\">\r\n              {{ getParticipantPoints(promo) }} / {{ promo.pointsRedeem }}\r\n            </label>\r\n          </td>\r\n\r\n          <td class=\"cell cell--data cell--points\">\r\n            <label class=\"cell__label\">\r\n              {{ promo.pointsEntry ? promo.pointsEntry : \"Nie było\" }}\r\n            </label>\r\n          </td>\r\n\r\n          <td\r\n            class=\"cell cell--data cell--participants cell--participants-total\"\r\n          >\r\n            <label\r\n              class=\"action-label action-label--list\"\r\n              [routerLink]=\"['/customer/promo/coupons']\"\r\n              [queryParams]=\"{\r\n                pid: promo.pid,\r\n                uid: user.uid,\r\n                promo: promo\r\n              }\"\r\n            >\r\n              Lista\r\n            </label>\r\n          </td>\r\n\r\n          <td class=\"cell cell--actions\">\r\n            <label\r\n              class=\"action-label action-label--delete\"\r\n              (click)=\"resign(promo, user)\"\r\n            >\r\n              zrezygnuj\r\n            </label>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table>\r\n  </ng-container>\r\n</div>\r\n"],"sourceRoot":"webpack:///"}